<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Admin view</title>

    <script
      src="https://code.jquery.com/jquery-3.7.1.min.js"
      integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
      crossorigin="anonymous"
    ></script>
    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"></script> -->

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="https://cdn.datatables.net/2.2.1/css/dataTables.bootstrap5.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.datatables.net/2.2.1/js/dataTables.js"></script>
    <script src="https://cdn.datatables.net/2.2.1/js/dataTables.bootstrap5.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="../Scripts/ajaxCalls.js"></script>

    <script>
      $(document).ready(function () {
        // new DataTable("#AdminTable");
        //getAdminGameList();
      });

      //return Admin Games
      function getAdminGameList() {
        const api = `https://localhost:7119/api/Games/ReadAdminGameList`;
        ajaxCall("GET", api, "", getGamesObjSCB, getGamesObjECB);
        function getGamesObjSCB(gamesObjList) {
          console.log("Ajax Success");
          console.log(gamesObjList);
          RenderAdminGameList(gamesObjList);
        }
        function getGamesObjECB(ERR) {
          //ECB
          console.log(ERR);
        }
      }

      function RenderAdminGameList(gamesObjList) {
        const $Table = $("#AdminTable tbody");
        const $TableHead = $("#AdminTable thead");

        // Clear existing table body and header
        $Table.empty();
        $TableHead.empty();

        // Dynamically add table headers
        $TableHead.append(`
          <tr>
          <th>App ID</th>
          <th>App Name</th>
          <th>Number of Purchases</th>
          <th>Revenue</th>
          </tr>
        `);

        // Append rows to the table body
        gamesObjList.forEach((gameObj) => {
          $Table.append(`<tr>
            <td>${gameObj.appid}</td>
            <td>${gameObj.name}</td>
            <td>${gameObj.numberOfPurchases}</td>
            <td>${gameObj.amountPaidFor}</td>
          </tr>`);
          console.log("Row executed successfully");
        });

        // Initialize DataTable after rendering the data
        $("#AdminTable").DataTable();
      }

      //return Admin User List
      function getAdminUserList() {
        const api = `https://localhost:7119/api/Users/ReadAdminUserList`;
        ajaxCall("GET", api, "", getUserObjSCB, getUserObjECB);
        function getUserObjSCB(userObjList) {
          console.log("Ajax Success");
          console.log(userObjList);
          RenderAdminUserList(userObjList);
        }
        function getUserObjECB(ERR) {
          //ECB
          console.log(ERR);
        }
      }

      function RenderAdminUserList(userObjList) {
        const $Table = $("#AdminTable tbody");
        const $TableHead = $("#AdminTable thead");

        // Clear existing table body and header
        $Table.empty();
        $TableHead.empty();

        // Dynamically add table headers
        $TableHead.append(`
          <tr>
          <th>User ID</th>
          <th>User Name</th>
          <th>Number of Purchases</th>
          <th>Mony Spent</th>
          <th>Is Active</th>
          </tr>
        `);

        // Append rows to the table body
        userObjList.forEach((userObj) => {
          $Table.append(`<tr>
            <td>${userObj.Id}</td>
            <td>${userObj.Name}</td>
            <td>${userObj.NumOfGames}</td>
            <td>${userObj.AmountOfMoneySpent}</td>
            <td><input type="checkbox" ${userObj.isActive ? "checked" : ""} disabled></td>
            </tr>`);
          console.log("Row executed successfully");
        });

        // Initialize DataTable after rendering the data
        $("#AdminTable").DataTable();
      }
    </script>
  </head>
  <body>
    <table id="AdminTable" class="table table-striped sm-1-" style="width: 100%">
      <thead></thead>
      <tbody></tbody>
    </table>
  </body>
</html>
